# Сборка приложений

* `JAR` (Java Archive) - zip-папка с `.class` и прочими файлами.

- `JAR` может быть исполняемым, если в нем прописан `MANIFEST.MF` с указанием главного класса.

- `JAR` может не содержать файла `MANIFEST.MF`, тогда данный архив по сути является библиотекой, которую можно использовать в своих проектах. Например, `JCommander`.

## Сборка приложений

- Подключение зависимостей
- Компиляция
- Упаковка в архив
- Дистрибутизация

## Системы сборки

* Maven - система сборки от Apache.

- Управление зависимостями
- Вызов инструментов компиляции
- Запуск модульных тестов
- Упаковка
- Дистрибутизация
- Удаленное размещение

## Maven-проект

* Проект, который будет собираться Maven-ом, должен иметь определенную структуру.

* src - файлы исходного кода
	* main - главные файлы исходного кода
		* java - файлы исходного кода на Java
		* resources - файлы ресурсов
	* test - файлы для модульного тестирования
		* java
		* resources

* target - результаты сборки

* pom.xml - главный файл Maven-проекта, содержит указания на зависмости, настройки сборки, профили проекта, плагины и т.д.

* Компиляция приложения с явным указанием компилятора

```
mvn -Dmaven.compiler.fork=true -Dmaven.compiler.executable="C:\Program Files\Java\jdk1.8.0_201\bin\javac" compile
```

### Фазы сборки

* `clean` - удаление папки `target`
* `compile` - компиляция приложения
* `package` - упаковка приложения в архив
* `install` - перемещение архива в локальный репозиторий (в `.m2`)

### Плагины

* `maven-shade-plugin` - плагин, который позволяет создавать запускаемые `jar`, упаковывая в них все зависимости, которые указаны в `pom.xml`.

### Как Maven работает с зависимостями?

1. Он видит в pom.xml какую-нибудь зависимость или плагин.
2. Он ищет скачанный `jar`-ник на компьютере, в локальном репозитории - в папке `.m2`.
3. Если в папке `.m2` зависмость не обнаружена, то он скачивает ее из сентрального репозитория и добавляет в папку `.m2`. 

### Полезные команды

* Вывод зависимостей

```
mvn dependency:tree
```
